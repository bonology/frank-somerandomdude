// Generated by CoffeeScript 1.4.0
/* --------------------------------------------
     Begin frank.slideshow.coffee
--------------------------------------------
*//*global
*/var FLB,FSS,image,images,loadDeferredImage,_i,_len;FSS=function(){function o(e,t){this.element=e;Object.prototype.toString.call(t)==="[object Object]"?this.options=t:this.options={};this.init();this.gotoslide(0);this.autoplay&&this.play()}var e,t,n,r,i,s;o.prototype.pause=function(){clearTimeout(this.interval)};o.prototype.play=function(){clearTimeout(this.interval);this.interval=setTimeout(e,this.duration,this)};o.prototype.next=function(){var e;e=this.currentIndex<this.slides.length-1?this.currentIndex+1:0;this.gotoslide(e)};o.prototype.gotoslide=function(e){var t,n;if(this.currentIndex===e)return;t=this.element.parentNode.querySelector(".visible");if(t&&t===this.slideA){this.slideB.style.backgroundPosition="0px "+String(this.options.height*e*-1)+"px";this.slideA.className=this.slideA.className.replace(new RegExp("(\\s|^)visible(\\s|$)"),"");this.slideB.className+=" visible"}else{this.slideA.style.backgroundPosition="0px "+String(this.options.height*e*-1)+"px";this.slideB.className=this.slideB.className.replace(new RegExp("(\\s|^)visible(\\s|$)"),"");this.slideA.className+=" visible"}t=this.navigation.querySelector(".active");t&&t.removeAttribute("class");t=document.createAttribute("class");t.nodeValue="active";this.navigation.childNodes.item(e).setAttributeNode(t);n=this.currentIndex===-1?0:this.currentIndex;this.slides[n].el.className=this.slides[n].el.className.replace(new RegExp("(\\s|^)active(\\s|$)"),"");this.slides[e].el.className+=" active";this.currentIndex=e};o.prototype.init=function(){var e,n,o,u,a,f,l,c,h;n=this;this.options.width||(this.options.width=this.element.offsetWidth);this.options.height||(this.options.height=this.element.offsetHeight);this.autoplay=!0;this.duration=5e3;this.currentIndex=-1;this.element.className.match(new RegExp("(\\s|^)fss(\\s|$)"))||(this.element.className+=" fss");this.caption=this.element.querySelector(".captions");if(!this.caption)return;e=this.caption.firstChild;a=0;this.slides=[];while(e){e&&e.nodeType!==3&&this.slides.push({ndx:a++,el:e});e=e.nextSibling}this.container=t("div","slide-container");this.slideA=t("div","slide-a visible");this.slideB=t("div","slide-b");this.element.insertBefore(this.container,this.caption);this.container.appendChild(this.slideA);this.container.appendChild(this.slideB);this.slideA.style.width=this.slideB.style.width=this.options.width+"px";this.slideA.style.height=this.slideB.style.height=this.options.height+"px";this.navigation=t("ul","fss-nav");h=this.slides;for(o=l=0,c=h.length;l<c;o=++l){f=h[o];u=t("li");u.appendChild(document.createTextNode(String(o+1)));this.navigation.appendChild(u);u.onclick=s(u,this)}this.container.appendChild(this.navigation);this.container.onmouseover=function(e){return i(e,n)};this.container.onmouseout=function(e){return r(e,n)}};t=function(e,t){var n,r;r=document.createElement(e);if(!t)return r;n=document.createAttribute("class");n.nodeValue=t;r.setAttributeNode(n);return r};n=function(e,t){if(e===t)return!1;while(e&&e!==t)e=e.parentNode;return e===t};e=function(e){if(!e)return;e.next();e.play()};s=function(e,t){return function(){var n;t.pause();n=0;while(t.navigation.childNodes.item(n)){if(t.navigation.childNodes.item(n)===e){t.gotoslide(n);return}n++}}};i=function(e,t){if(!e)return;if(!n(e.target,t.container)){e.cancelBubble=!0;e.stopPropagation();return!1}t.pause();t.navigation.className.match(new RegExp("(\\s|^)active(\\s|$)"))||(t.navigation.className+=" active")};r=function(e,t){if(n(e.relatedTarget,t.container)){e.cancelBubble=!0;e.stopPropagation();return!1}t.play();t.navigation.className.match(new RegExp("(\\s|^)active(\\s|$)"))&&(t.navigation.className=t.navigation.className.replace(new RegExp("(\\s|^)active(\\s|$)"),""))};return o}();FLB=function(){function i(e,t){this.element=e;Object.prototype.toString.call(t)==="[object Object]"?this.options=t:this.options={};this.options.resizeImage=!1;this.init()}var e,t,n,r;i.prototype.init=function(){var t;t=this;this.element.onclick=function(n){return e(n,t)}};i.prototype.createOverlay=function(e){var r;r=this;this.overlay=document.createElement("div");this.overlay.setAttribute("id","flb-overlay");this.overlay.innerHTML='<div id="flb-container"><a href="#" title="Close" class="closingElement">&nbsp;</a></div><div id="flb-content"><a id="flb-image" class="closingElement" href="#" title="Close"></a><a id="flb-close" class="closingElement" href="#" title="Close">&times;</a></div>';document.getElementsByTagName("body")[0].appendChild(this.overlay);this.container=document.getElementById("flb-content");this.container.onclick=this.overlay.onclick=function(e){return t(e,r)};this.imgContainer=document.getElementById("flb-image");this.imgContainer.style.background="url("+e+") no-repeat 50% 50%";this.image=new Image;this.image.onload=function(e){return n(e,r)};this.image.src=e};n=function(e,t){var n,i,s,o;if(!t.options.resizeImage){i=t.image.height;s=t.image.width}else{o=document.documentElement.clientHeight-40;if(t.image.height<o){i=t.image.height;s=t.image.width}else{i=o;s=Math.round(o*t.image.width/t.image.height);t.image.height=i;t.image.width=s}}n=function(){return r(t.container,s,i)};setTimeout(n,600)};r=function(e,t,n){e.style.width=t+"px";e.style.height=n+"px";e.style.margin="-"+(n+28)/2+"px 0 0 -"+t/2+"px";e.setAttribute("class","active")};e=function(e,t){t.createOverlay(e.currentTarget.getAttribute("href"));e.cancelBubble=!0;e.stopPropagation();return!1};t=function(e,t){t.container.setAttribute("class","");document.getElementsByTagName("body")[0].removeChild(t.overlay)};return i}();loadDeferredImage=function(e){var t,n;n=e.getAttribute("data-defer-src");t=document.createAttribute("src");t.nodeValue=n;e.setAttributeNode(t)};images=document.querySelectorAll("img[data-defer-src]");for(_i=0,_len=images.length;_i<_len;_i++){image=images[_i];loadDeferredImage(image)}window.onload=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v;if(!document.querySelector)return;f=document.querySelectorAll("#hero_slideshow .slideshow");if(f.length)for(l=0,p=f.length;l<p;l++){a=f[l];t=new FSS(a,{width:725,height:210})}r=document.querySelectorAll("a[rel=simplebox]");if(r.length)for(c=0,d=r.length;c<d;c++){n=r[c];e=new FLB(n,{})}i=function(e,t){return function(){var n,r,i,s,o,u,a,f;n=e.getAttribute("rel");for(o=0,u=t.length;o<u;o++){r=t[o];r.className.match(new RegExp("(\\s|^)active(\\s|$)"))&&(r.className=r.className.replace(new RegExp("(\\s|^)active(\\s|$)"),""))}s=document.querySelectorAll("#projects_list li");for(f=0,a=s.length;f<a;f++){i=s[f];i.className.match(new RegExp("(\\s|^)deselected(\\s|$)"))&&(i.className=i.className.replace(new RegExp("(\\s|^)deselected(\\s|$)"),""));n!=="all"&&!i.className.match(new RegExp("(\\s|^)"+n+"(\\s|$)"))&&(i.className.match(new RegExp("(\\s|^)deselected(\\s|$)"))||(i.className+=" deselected"))}e.className=" active"}};if(document.querySelector("#p72")){o=document.querySelectorAll("#projects-nav dd");for(h=0,v=o.length;h<v;h++){s=o[h];s.onclick=i(s,o)}}u=document.querySelector("#post-tweet");if(u)return u.onclick=function(){var e,t;e=window.screen.width/2-275;t=window.screen.height/2-235;window.open(this.href,this.getAttribute("target"),"width=550, height=470, location=0, left="+e+", top="+t);return!1}};